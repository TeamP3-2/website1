<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Ù…Ø³Ø§Ø±ÙŠ - Ø¯ÙˆØ±Ø§ØªÙŠ</title>
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/body.css">
    <link rel="stylesheet" href="../css/corses.css"> 

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>

<body>

    <header>
        <div class="header-box">
            <div class="logo-container">
                <img src="../image/dd.png" alt="Logo">
                <h4>Ù…Ø³Ø§Ø±ÙŠ</h4>
            </div>
        </div>
        <nav>
            <ul class="nav-list">
                <li><a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                <li><a href="about.html">Ù…Ù† Ù†Ø­Ù†</a></li>
                <li><a href="courses.html">Ø¯ÙˆØ±Ø§ØªÙŠ</a></li>
                <li><a href="dashboard.html">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</a></li>
                <li><a href="contact.html">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a></li>
            </ul>
        </nav>
        <div class="logout-container">
            <span class="logout-text">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
            <a href="#" class="logout-link" id="logoutBtn">
                <span class="logout-text">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</span>
                <i class="fas fa-sign-out-alt"></i>
            </a>
        </div>
    </header>

    <main>

        <h2><i class="fa-solid fa-book-open"></i> Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„ØªÙŠ Ù‚Ù…Øª Ø¨ØªØ³Ø¬ÙŠÙ„Ù‡Ø§</h2>
        <div id="coursesContainer1" class="courses-container"></div>

        <h2>Ø¯ÙˆØ±Ø§Øª Ù…Ù‚ØªØ±Ø­Ø© Ù„Ùƒ</h2>
        <!-- <div id="recommendations"></div> -->
        <div id="similarCourses"></div>


        <script>


        let enrolledCourses = JSON.parse(localStorage.getItem("enrolledCourses")) || [];
            // const enrolledCourses = [30, 1285];
            console.log("enrolledCourses R s:", enrolledCourses);

        
console.log("Ø§Ù„Ù€ enrolledCourses:", enrolledCourses);

fetch("http://127.0.0.1:8000/myrec", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ "course_ids": enrolledCourses })  // Sending list of course IDs
})
    .then(response => response.json())
    .then(data => {
    console.log("Ø¹Ø¯Ø¯ Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:", data.recommendations.length);

        if (Array.isArray(data.recommendations)) {
            console.log("Hereeeee Recommendations:", data.recommendations);
            let similarCoursesContainer = document.getElementById("similarCourses");

            // Using map to generate HTML for all recommended courses
            const recommendationsHTML = data.recommendations.map(course => {
                return `
                <div class="course-card1">
                        <h5>${course.course_name}</h5>
                        <p><strong>University:</strong> ${course.university}</p>
                        <p><strong>Level:</strong> ${course.difficulty_level}</p>
                        <p><strong>Rating:</strong> ${course.course_rating}</p>
                        <span class="inff" onclick="showMoreInfo(${course.course_id})">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²ÙŠØ¯</span>
                    </div>
                `;
            }).join(""); 
             // Join the array of HTML strings into one string

            // Insert the HTML into the container
            similarCoursesContainer.innerHTML = recommendationsHTML;
        } else {
            console.error("No recommendations found");
        }
    })
    .catch(error => console.error("Error:", error));







            // Function to show more course information in a new window
            function showMoreInfo(courseId) {
                fetch("http://localhost:3000/api/course")
                    .then(response => response.json())
                    .then(courses => {
                        const course = courses.find(c => Number(c.ID) === courseId);
                        if (course) {
                            const url = `../html/courseDetails.html?courseId=${courseId}`;
                            window.open(url, '_blank');
                        } else {
                            alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ±Ø©!");
                        }
                    })
                    .catch(error => {
                        console.error("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø©:", error);
                        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø©.");
                    });
            }


            // let enrolledCourses = localStorage.getItem("enrolledCourses");

            // try {
            //     enrolledCourses = JSON.parse(enrolledCourses);
            // } catch (error) {
            //     console.error("âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage:", error);
            //     enrolledCourses = [];
            // }

            // // Ensure it's an array
            // if (!Array.isArray(enrolledCourses)) {
            //     enrolledCourses = [];
            // }

            // // Now enrolledCourses contains the list of stored course IDs
            // console.log("ğŸ“Œ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ courseId Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ localStorage:", enrolledCourses);




        </script>
        </section>

    </main>
    <script src="../js/script.js"></script>

</body>

</html>